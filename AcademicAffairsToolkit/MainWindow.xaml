<Fluent:RibbonWindow x:Class="AcademicAffairsToolkit.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AcademicAffairsToolkit"
        mc:Ignorable="d"
        xmlns:Fluent="urn:fluent-ribbon"
        Title="Academic Affairs Toolkit"
        Height="450" Width="800" MinHeight="240" MinWidth="320"
        WindowStartupLocation="CenterScreen"
        AllowDrop="True"
        DragEnter="RibbonWindow_DragEnter">

    <Window.CommandBindings>
        <CommandBinding Command="Open" CanExecute="OpenCommandCanExecute" Executed="OpenCommandExecuted"/>
        <CommandBinding Command="Save" CanExecute="SaveCommandCanExecute" Executed="SaveCommandExecuted"/>
        <CommandBinding Command="Close" CanExecute="CloseCommandCanExecute" Executed="CloseCommandExecuted"/>
        <CommandBinding Command="{x:Static local:MainWindow.ToggleView}" CanExecute="ToggleViewCommandCanExecute" Executed="ToggleViewCommandExecuted"/>
        <CommandBinding Command="{x:Static local:MainWindow.StartArrangement}" CanExecute="StartArrangementCanExecute" Executed="StartArrangementExecuted"/>
    </Window.CommandBindings>

    <DockPanel>
        <Fluent:Ribbon DockPanel.Dock="Top">
            <!--file menu-->
            <Fluent:Ribbon.Menu>
                <Fluent:Backstage>
                    <Fluent:BackstageTabControl>
                        <Fluent:BackstageTabItem Header="Open">
                            <Grid Margin="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <StackPanel Grid.Row="1" Grid.Column="0">
                                    <Fluent:Button Height="Auto"
                                                   Header="Open invigilate file..."
                                                   Command="Open"
                                                   Icon="{StaticResource OpenFileIcon}"
                                                   LargeIcon="{StaticResource OpenFileIcon}"
                                                   CommandParameter="invigilate"/>
                                    <Fluent:Button Height="Auto"
                                                   Header="Open TR office file..."
                                                   Command="Open"
                                                   Icon="{StaticResource OpenFileIcon}"
                                                   LargeIcon="{StaticResource OpenFileIcon}"
                                                   CommandParameter="tr"/>
                                </StackPanel>
                                <TextBlock Grid.Row="0" Grid.Column="1" FontSize="24" Margin="20">
                                    Recent
                                </TextBlock>
                                <Fluent:Gallery Grid.Column="1"
                                                Grid.Row="1"
                                                Name="recentlyOpenedGallery"
                                                MaxItemsInRow="1"
                                                Margin="20,0">
                                    <Fluent:Gallery.ContextMenu>
                                        <Fluent:ContextMenu>
                                            <Fluent:MenuItem Header="Open as invigilate file"/>
                                            <Fluent:MenuItem Header="Open as TR file"/>
                                        </Fluent:ContextMenu>
                                    </Fluent:Gallery.ContextMenu>
                                </Fluent:Gallery>
                            </Grid>
                        </Fluent:BackstageTabItem>

                        <Fluent:Button Header="Save As"
                                       Command="Save"/>

                        <Fluent:BackstageTabItem Header="Settings">
                            <StackPanel Orientation="Horizontal" Margin="20">
                                <GroupBox Header="Data range" Margin="5" BorderThickness="0">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Margin="5,5">Note: negative number = from bottom</TextBlock>
                                        <Fluent:ComboBox Header="Start Row" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="Start column" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="End row" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="End column" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox Header="Columns" Margin="5" BorderThickness="0">
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Margin="5,5">Note: negative number = from right</TextBlock>
                                        <Fluent:ComboBox Header="Course name" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="Date" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="Time" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="Invigilator count" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:ComboBox Header="Examinees count" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                        <Fluent:TextBox Header="Inviligators Regex" InputWidth="100" Height="24" HorizontalContentAlignment="Right"/>
                                    </StackPanel>
                                </GroupBox>
                                <GroupBox Header="Appearance" Margin="5" BorderThickness="0">
                                    <ItemsControl>
                                        <Fluent:RadioButton Header="Automatic" GroupName="appearance" IsChecked="True"/>
                                        <Fluent:RadioButton Header="Light" GroupName="appearance"/>
                                        <Fluent:RadioButton Header="Dark" GroupName="appearance"/>
                                    </ItemsControl>
                                </GroupBox>
                            </StackPanel>
                        </Fluent:BackstageTabItem>

                        <Fluent:BackstageTabItem Header="About">
                            <TextBlock Margin="20" LineHeight="1.5">
                                <Run FontSize="36">Academic Affairs Toolkit</Run><LineBreak/>
                                Version 0.0.0.1<LineBreak/>
                                Third-party libraries: Fluent.Ribbon, npoi<LineBreak/>
                                Icons: Visual Studio 2019 Icons Library
                            </TextBlock>
                        </Fluent:BackstageTabItem>

                        <Fluent:SeparatorTabItem/>

                        <Fluent:Button Header="Close"
                                       Command="Close"/>
                    </Fluent:BackstageTabControl>
                </Fluent:Backstage>
            </Fluent:Ribbon.Menu>

            <!--home tab-->
            <Fluent:RibbonTabItem Header="Home" ReduceOrder="viewGroup,sortByGroup,clipboardGroup,constraintGroup">
                <Fluent:RibbonGroupBox Name="clipboardGroup" Header="Clipboard">
                    <Fluent:Button Header="Paste"
                                   Icon="{StaticResource Fluent.Ribbon.Images.Paste}"
                                   LargeIcon="{StaticResource Fluent.Ribbon.Images.Paste}"
                                   Command="Paste"/>
                    <Fluent:Button Header="Copy"
                                   Icon="{StaticResource Fluent.Ribbon.Images.Copy}"
                                   LargeIcon="{StaticResource Fluent.Ribbon.Images.Copy}"
                                   Command="Copy"/>
                    <Fluent:Button Header="Cut"
                                   Icon="{StaticResource Fluent.Ribbon.Images.Cut}"
                                   LargeIcon="{StaticResource Fluent.Ribbon.Images.Cut}"
                                   Command="Cut"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Arrange">
                    <Fluent:Button Header="Start auto arrange"
                                   Icon="{StaticResource StartIcon}"
                                   LargeIcon="{StaticResource StartIcon}"
                                   Command="{x:Static local:MainWindow.StartArrangement}"/>
                    <Fluent:Button Header="Arrangement Policy"
                                   Icon="{StaticResource PolicyIcon}"
                                   LargeIcon="{StaticResource PolicyIcon}"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Name="constraintGroup" Header="Constraints">
                    <Fluent:ToggleButton Header="Enable constraints"
                                         Icon="{StaticResource EnableRuleIcon}"
                                         LargeIcon="{StaticResource EnableRuleIcon}"/>
                    <Fluent:SplitButton Header="Manage..."
                                        Icon="{StaticResource RuleIcon}"
                                        LargeIcon="{StaticResource RuleIcon}">
                        <Fluent:MenuItem Header="Add exclude rule"
                                         Icon="{StaticResource NewRuleIcon}"/>
                        <Fluent:MenuItem Header="Manage constraints"
                                         Icon="{StaticResource RuleIcon}"/>
                    </Fluent:SplitButton>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Name="sortByGroup" Header="Sort by">
                    <Fluent:InRibbonGallery ItemWidth="60">
                        <Fluent:GalleryItem>
                            <TextBlock>Name</TextBlock>
                        </Fluent:GalleryItem>
                        <Fluent:GalleryItem>
                            <TextBlock>Person</TextBlock>
                        </Fluent:GalleryItem>
                        <Fluent:InRibbonGallery.Menu>
                            <Fluent:RibbonMenu>
                                Invert order
                            </Fluent:RibbonMenu>
                        </Fluent:InRibbonGallery.Menu>
                    </Fluent:InRibbonGallery>
                </Fluent:RibbonGroupBox>

            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem Header="View">
                <Fluent:RibbonGroupBox Header="Original File Views">
                    <Fluent:ToggleButton x:Name="invigilateFileViewButton"
                                         Header="Invigilate file"
                                         GroupName="viewGroup"
                                         Icon="{StaticResource RawFileIcon}"
                                         LargeIcon="{StaticResource RawFileIcon}"
                                         Command="{x:Static local:MainWindow.ToggleView}"
                                         CommandParameter="/InvigilateFileViewPage.xaml"/>
                    <Fluent:ToggleButton Name="trOfficeFileViewButton"
                                         Header="TR office file"
                                         GroupName="viewGroup"
                                         Icon="{StaticResource RawFileIcon}"
                                         LargeIcon="{StaticResource RawFileIcon}"
                                         Command="{x:Static local:MainWindow.ToggleView}"
                                         CommandParameter="/TRFileViewPage.xaml"/>
                </Fluent:RibbonGroupBox>
                
                <Fluent:RibbonGroupBox Name="viewGroup" Header="Result View">
                    <Fluent:ToggleButton Name="tableViewButton"
                                         Header="Plain table"
                                         GroupName="viewGroup"
                                         Icon="{StaticResource TableIcon}"
                                         LargeIcon="{StaticResource TableIcon}"
                                         Command="{x:Static local:MainWindow.ToggleView}"
                                         CommandParameter="/TableViewPage.xaml"/>
                    <Fluent:ToggleButton Name="ganttViewButton"
                                         Header="Gantt"
                                         GroupName="viewGroup"
                                         Icon="{StaticResource GanttIcon}"
                                         LargeIcon="{StaticResource GanttIcon}"
                                         Command="{x:Static local:MainWindow.ToggleView}"
                                         CommandParameter="/GanttViewPage.xaml"/>
                    <Fluent:ToggleButton Name="calendarViewButton"
                                         Header="Calendar"
                                         GroupName="viewGroup"
                                         Icon="{StaticResource CalendarIccon}"
                                         LargeIcon="{StaticResource CalendarIccon}"
                                         Command="{x:Static local:MainWindow.ToggleView}"
                                         CommandParameter="/CalendarViewPage.xaml"/>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
        </Fluent:Ribbon>

        <!--status bar-->
        <Fluent:StatusBar DockPanel.Dock="Bottom" ClipToBounds="False">
            <Fluent:StatusBarItem HorizontalAlignment="Left">
                <TextBlock TextTrimming="CharacterEllipsis" MinWidth="200">
                    To begin, please open an Excel file.
                    Click File > "Open..." and select a file(or drag and drop a file).
                </TextBlock>
            </Fluent:StatusBarItem>
        </Fluent:StatusBar>

        <!--window content-->
        <Frame Name="mainViewFrame" NavigationUIVisibility="Hidden"/>
    </DockPanel>
</Fluent:RibbonWindow>
