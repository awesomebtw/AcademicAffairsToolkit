<Fluent:RibbonWindow x:Class="AcademicAffairsToolkit.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        xmlns:Fluent="urn:fluent-ribbon"
        Title="Academic Affairs Toolkit" Height="450" Width="800" MinHeight="240" MinWidth="320"
        WindowStartupLocation="CenterScreen"
        DragEnter="RibbonWindow_DragEnter">

    <DockPanel>
        <Fluent:Ribbon DockPanel.Dock="Top">
            <!--file menu-->
            <Fluent:Ribbon.Menu>
                <Fluent:Backstage>
                    <Fluent:BackstageTabControl>
                        <Fluent:BackstageTabItem Header="Open">
                            <Grid Margin="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Fluent:Button Grid.Column="0" Name="backstageOpenButton" Visibility="Visible"
                                               Header="Open..." VerticalAlignment="Top" Click="backstageOpenButton_Click"
                                               Icon="{StaticResource OpenFileIcon}"
                                               LargeIcon="{StaticResource OpenFileIcon}"/>
                                <Fluent:Gallery Grid.Column="1" Name="recentlyOpenedGallery" MaxItemsInRow="1" Margin="20,0">
                                    <Fluent:GalleryItem>
                                        <TextBlock>
                                            <Run Text="TODO: " Foreground="GreenYellow"/>
                                            recently-opened files will be here
                                        </TextBlock>
                                    </Fluent:GalleryItem>
                                </Fluent:Gallery>
                            </Grid>
                        </Fluent:BackstageTabItem>
                        <Fluent:BackstageTabItem Header="Save">
                            <TextBlock Margin="20">
                                <Run Text="TODO: " Foreground="GreenYellow"/>
                                add options to save arranged files as other formats
                            </TextBlock>
                        </Fluent:BackstageTabItem>
                        <Fluent:BackstageTabItem Header="Settings">
                            <WrapPanel Margin="20">
                                <Fluent:ComboBox Header="Theme">
                                    <ComboBoxItem Content="Operating System"/>
                                    <ComboBoxItem Content="Light"/>
                                    <ComboBoxItem Content="Dark"/>
                                </Fluent:ComboBox>
                                <TextBlock>TODO: settings will be here</TextBlock>
                            </WrapPanel>
                        </Fluent:BackstageTabItem>
                        <Fluent:BackstageTabItem Header="About">
                            <TextBlock Margin="20">
                                <Run FontSize="36">Academic Affairs Toolkit</Run><LineBreak/>
                                Version 0.0.0.1<LineBreak/>
                                Third-party libraries: Fluent.Ribbon, npoi<LineBreak/>
                                Icons: Visual Studio 2019 Icons Library
                            </TextBlock>
                        </Fluent:BackstageTabItem>
                        <Fluent:SeparatorTabItem/>
                        <Fluent:Button Name="backStageExitButton" Header="Exit" Click="backStageExitButton_Click"/>
                    </Fluent:BackstageTabControl>
                </Fluent:Backstage>
            </Fluent:Ribbon.Menu>

            <!--quick access bar-->
            <Fluent:Ribbon.QuickAccessItems>
                <Fluent:QuickAccessMenuItem Header="Open" ToolTip="Open" Click="backstageOpenButton_Click"
                                            Icon="{StaticResource OpenFileIcon}" Visibility="Visible"/>
            </Fluent:Ribbon.QuickAccessItems>

            <!--home tab-->
            <Fluent:RibbonTabItem Header="Home" ReduceOrder="viewGroup,sortByGroup,clipboardGroup,constraintGroup">
                <Fluent:RibbonGroupBox Name="clipboardGroup" Header="Clipboard">
                    <Fluent:Button Header="Paste"
                                   Icon="{StaticResource Fluent.Ribbon.Images.Paste}"
                                   LargeIcon="{StaticResource Fluent.Ribbon.Images.Paste}"/>
                    <Fluent:Button Header="Copy"
                                   Icon="{StaticResource Fluent.Ribbon.Images.Copy}"
                                   LargeIcon="{StaticResource Fluent.Ribbon.Images.Copy}"/>
                    <Fluent:Button Header="Cut"
                                   Icon="{StaticResource Fluent.Ribbon.Images.Cut}"
                                   LargeIcon="{StaticResource Fluent.Ribbon.Images.Cut}"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Arrange">
                    <Fluent:Button Header="Start auto arrange"
                                   Icon="{StaticResource StartIcon}"
                                   LargeIcon="{StaticResource StartIcon}"/>
                    <Fluent:Button Header="Arrangement Policy"
                                   Icon="{StaticResource PolicyIcon}"
                                   LargeIcon="{StaticResource PolicyIcon}"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Name="constraintGroup" Header="Constraints">
                    <Fluent:ToggleButton Header="Enable constraints"
                                         Icon="{StaticResource EnableRuleIcon}"
                                         LargeIcon="{StaticResource EnableRuleIcon}"/>
                    <Fluent:SplitButton Header="Manage..."
                                        Icon="{StaticResource RuleIcon}"
                                        LargeIcon="{StaticResource RuleIcon}">
                        <Fluent:MenuItem Header="Add time constraint"
                                         Icon="{StaticResource NewRuleIcon}"/>
                        <Fluent:MenuItem Header="Add personnel constraint"
                                         Icon="{StaticResource NewRuleIcon}"/>
                        <Fluent:MenuItem Header="Manage constraints"
                                         Icon="{StaticResource RuleIcon}"/>
                    </Fluent:SplitButton>
                    <Fluent:Button Header="Person setting"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Name="viewGroup" Header="View">
                    <Fluent:ToggleButton Header="Original file"
                                         Icon="{StaticResource RawFileIcon}"
                                         LargeIcon="{StaticResource RawFileIcon}"/>
                    <Fluent:ToggleButton Header="Plain table"
                                         Icon="{StaticResource TableIcon}"
                                         LargeIcon="{StaticResource TableIcon}"/>
                    <Fluent:ToggleButton Header="Gantt"
                                         Icon="{StaticResource GanttIcon}"
                                         LargeIcon="{StaticResource GanttIcon}"/>
                    <Fluent:ToggleButton Header="Calendar"
                                         Icon="{StaticResource CalendarIccon}"
                                         LargeIcon="{StaticResource CalendarIccon}"/>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Name="sortByGroup" Header="Sort by">
                    <Fluent:InRibbonGallery ItemWidth="60">
                        <Fluent:GalleryItem>
                            <TextBlock>Name</TextBlock>
                        </Fluent:GalleryItem>
                        <Fluent:GalleryItem>
                            <TextBlock>Person</TextBlock>
                        </Fluent:GalleryItem>
                        <Fluent:InRibbonGallery.Menu>
                            <Fluent:RibbonMenu>
                                Invert order
                            </Fluent:RibbonMenu>
                        </Fluent:InRibbonGallery.Menu>
                    </Fluent:InRibbonGallery>
                </Fluent:RibbonGroupBox>

            </Fluent:RibbonTabItem>

            <!--tab for data preprocessing-->
            <Fluent:RibbonTabItem Header="Data Preprocessing" Group="{Binding Source={x:Reference toolsGroup}}">
                <Fluent:RibbonGroupBox Header="Data Range">
                    <Fluent:ComboBox Header="Start Row" InputWidth="60"/>
                    <Fluent:ComboBox Header="Start column" InputWidth="60"/>
                    <Separator HorizontalAlignment="Left"/>
                    <Fluent:ComboBox Header="End row" InputWidth="60"/>
                    <Fluent:ComboBox Header="End column" InputWidth="60"/>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="Columns">
                    <Fluent:ComboBox Header="Course name" InputWidth="60" HorizontalContentAlignment="Right"/>
                    <Fluent:ComboBox Header="Date" InputWidth="60" HorizontalContentAlignment="Right"/>
                    <Fluent:ComboBox Header="Time" InputWidth="60"/>
                    <Fluent:ComboBox Header="Personnel requirement" InputWidth="60"/>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:Ribbon.ContextualGroups>
                <Fluent:RibbonContextualTabGroup x:Name="toolsGroup" Header="File tools" Visibility="Visible"
                                                 Background="Green" BorderBrush="Green"/>
            </Fluent:Ribbon.ContextualGroups>
        </Fluent:Ribbon>

        <!--status bar-->
        <Fluent:StatusBar DockPanel.Dock="Bottom" ClipToBounds="False">
            <Fluent:StatusBarItem HorizontalAlignment="Left">
                <TextBlock TextTrimming="CharacterEllipsis" MinWidth="200">
                    To begin, please open an Excel file.
                    Click File > "Open..." and select a file(or drag and drop a file).
                </TextBlock>
            </Fluent:StatusBarItem>
            <Fluent:StatusBarItem HorizontalAlignment="Right" MinWidth="50">
                <ProgressBar Value="20" Minimum="0" Maximum="100" Visibility="Visible" Height="12"/>
            </Fluent:StatusBarItem>
        </Fluent:StatusBar>
        
        <!--window content-->
        <WrapPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Vertical">
            <TextBlock><Run Foreground="GreenYellow" Text="TODO: "/>add views for main window</TextBlock>
        </WrapPanel>
    </DockPanel>
</Fluent:RibbonWindow>
